name: CI - Frontend Build Check

on:
  push:
    branches: [ "master"]
    paths-ignore:
      - 'README.md'
      - '.github/**'
  pull_request:
    branches: [ "master"]
  workflow_dispatch:

jobs:
  build-check:
    name: Verify Build (Node 22)
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      # ✨ 新增步骤：安装 pnpm 环境
      # 对应你本地的 pnpm v10
      - name: Install pnpm
        uses: pnpm/action-setup@v4
        with:
          version: 10

      - name: Set up Node.js 22
        uses: actions/setup-node@v4
        with:
          node-version: '22'
          # ✨ 修改缓存配置：改为 'pnpm'
          cache: 'pnpm'

      - name: Install Dependencies
        # ✨ 修改安装命令：使用 pnpm
        # --frozen-lockfile 相当于 npm ci，确保完全按照 lock 文件安装
        run: pnpm install --frozen-lockfile

      - name: Check Type & Lint (Optional)
        run: echo "Skipping lint check for now..."

      - name: Run Production Build
        # ✨ 修改构建命令
        run: pnpm run build